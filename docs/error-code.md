# 에러 코드 가이드

## 개요

MatchDay API는 통일된 에러 응답 형식과 체계적인 에러 코드를 사용합니다. 모든 API 에러는 `ApiExceptionResponse` 형식으로 반환되며, HTTP 상태 코드와 함께 커스텀 상태 코드를 제공합니다.

## 공통 에러 응답 형식

### 기본 구조

```json
{
    "httpStatusCode": 400,
    "customStatusCode": 4001,
    "message": "이미 존재하는 유저 이름",
    "data": null
}
```

### 상세 구조 (Validation 에러)

```json
{
    "httpStatusCode": 400,
    "customStatusCode": 400,
    "message": "Wrong Request",
    "data": [
        "username : { existingUser } 은 이미 사용 중인 사용자명입니다",
        "email : { invalid@domain } 은 올바른 이메일 형식이 아닙니다"
    ]
}
```

## 공통 Exception 처리

### REST API 에러 처리

- **위치**: `ApiExceptionHandler.java`
- **어노테이션**: `@RestControllerAdvice`
- **처리 방식**: 
  - `ApiException`: 비즈니스 로직 에러
  - `MethodArgumentNotValidException`: Validation 에러
  - `AuthorizationDeniedException`: 권한 에러
  - `Exception`: 기타 모든 에러

### WebSocket 에러 처리

- **위치**: `WebSocketExceptionHandler.java`
- **어노테이션**: `@ControllerAdvice`
- **처리 방식**: WebSocket 메시지를 통한 에러 전송

## 에러 코드 체계

### 기본 시스템 에러 (HTTP 상태 코드와 동일)

| 코드 | HTTP | 설명 |
|------|------|------|
| 200 | 200 | OK |
| 400 | 400 | Wrong Request (Validation 에러) |
| 403 | 403 | Forbidden (권한 부족) |
| 500 | 500 | Unknown Error (서버 내부 에러) |

### 사용자 관련 (4000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 4001 | 400 | 이미 존재하는 유저 이름 |
| 4002 | 404 | 존재하지 않는 유저입니다 |

### 팀 관련 (5000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 5001 | 400 | 이미 존재하는 팀 이름 |
| 5002 | 404 | 존재하지 않는 팀입니다 |
| 5003 | 400 | 팀에 이미 유저가 소속되어있음 |
| 5004 | 400 | 현재 해당 팀에 활동 중이 아닌 사용자입니다 |

### 매치 관련 (6000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 6001 | 400 | 경기명을 입력하세요 |
| 6002 | 400 | 존재하지 않는 팀입니다 |
| 6003 | 400 | 홈 팀과 어웨이 팀은 동일할 수 없습니다 |
| 6004 | 400 | 경기장을 입력하세요 |
| 6005 | 400 | 과거 날짜는 등록할 수 없습니다 |
| 6006 | 400 | 시작 시간은 종료시간 보다 빨라야합니다 |
| 6007 | 404 | 존재하지 않는 매치 입니다 |
| 6008 | 400 | 경기에 참여중이지 않은 선수입니다 |
| 6009 | 403 | 기록할 수 없는 유저입니다 |
| 6010 | 500 | 웹소켓 오류 |
| 6011 | 400 | 해당 팀은 입력받은 경기의 홈팀도, 어웨이팀도 아닙니다 |
| 6012 | 404 | 존재하지 않는 매모 입니다 |
| 6013 | 400 | 서로 다른 팀의 선수는 교체할 수 없습니다 |
| 6014 | 400 | 잘못된 HALF 타입입니다 |
| 6015 | 400 | 종료 시간은 시작 시간보다 늦어야합니다 |
| 6016 | 400 | 후반 시작 시간은 전반 종료 시간 보다 늦어야합니다 |
| 6017 | 404 | 존재하지 않는 경기 이벤트입니다 |
| 6018 | 404 | 유효한 경기 기간은 1분~45분입니다 |
| 6019 | 400 | page는 음수 값이 될 수 없습니다 |
| 6020 | 400 | size는 1이상의 값이어야 합니다 |
| 6021 | 400 | 진행 중인 경기가 아닙니다 |
| 6022 | 400 | 이벤트 발생 시간 계산 중 에러가 발생했습니다 |

### 매치 유저 관련 (7000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 7001 | 404 | 존재하지 않는 매치입니다 |
| 7002 | 400 | 매치에 이미 등록된 유저입니다 |
| 7003 | 404 | 존재하지 않는 매치 유저입니다 |
| 7004 | 404 | 해당 좌표에 이미 누군가 배치되어있습니다 |

### 파일 관련 (8000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 8001 | 400 | 지원하지 않는 파일 확장자입니다 |
| 8002 | 404 | 존재하지 않는 파일입니다 |
| 8003 | 404 | 파일 확장자가 비어있습니다 |
| 8004 | 500 | S3 접근 중 오류가 발생했습니다 |
| 8005 | 400 | 유효하지 않은 폴더명입니다 |

### JWT 관련 (9000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 9000 | 401 | JWT 토큰 검증 실패 |
| 9001 | 401 | 올바른 Bearer 형식이 아님, Bearer(공백) 총 7자 |
| 9002 | 401 | JWT 엑세스 토큰이 만료됨 |
| 9003 | 401 | JWT 리프레시 토큰이 만료됨 |
| 9004 | 401 | JWT 서명이 적절하지 않음 |
| 9005 | 401 | JWT 형식이 잘못됨 |
| 9006 | 401 | 유효하지 않은 JWT 토큰 |
| 9007 | 400 | 적절한 토큰 타입이 아닙니다(ACCESS,REFRESH) |
| 9008 | 404 | 쿠키에서 토큰값을 찾을 수 없습니다 |
| 9009 | 404 | 토큰 페이로드 정보로 찾을 수 없는 사용자 입니다 |
| 9010 | 400 | 현재 유저에 해당하는 리프레시 토큰이 아닙니다 |

### 인증/권한 관련 (10000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 10001 | 401 | 인증되지 않은 사용자, Authentication 객체가 없음 |
| 10002 | 401 | 권한이 부족합니다 |
| 10003 | 400 | 승인된 redirection uri 가 아닙니다 |

### 어노테이션 관련 (11000번대)

| 코드 | HTTP | 설명 |
|------|------|------|
| 11001 | 400 | 올바른 Annotation 사용법이 아님 |

### WebSocket 관련 (20000번대)



## StatusInterface 구현

모든 에러 코드는 `StatusInterface`를 구현하며, 다음 메서드를 제공합니다:

```java
public interface StatusInterface {
    int getHttpStatusCode();      // HTTP 상태 코드
    int getCustomStatusCode();    // 커스텀 상태 코드
    String getDescription();      // 에러 설명
}
```

## 에러코드 범위 

새로운 도메인의 에러 코드는 1000번지씩 증가하며, 다음과 같은 범위를 가집니다가

- 1000번대: 기본 시스템 에러
- 4000번대: 사용자 관련
- 5000번대: 팀 관련
- 6000번대: 매치 관련
- 7000번대: 매치 유저 관련
- 8000번대: 파일 관련
- 9000번대: JWT 관련
- 10000번대: 인증/권한 관련
- 11000번대: 어노테이션 관련
- 12000번대: WebSocket 관련 (예약)

